<!DOCTYPE html>
<html lang="ar" dir="rtl">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مطعم ألتا - قائمة شاملة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- Global Reset & Box Sizing --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        /* --- General Styles --- */
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #fffaf0;
            color: #4a3b31;
            line-height: 1.6;
            overflow-x: hidden; /* <<---  منع التمرير الأفقي للصفحة  ---<< */
        }
        .navbar {
            background-color: #982f34; color: white; padding: 12px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex;
            justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 1000;
        }
        .navbar-brand {
            font-size: 1.6em; font-weight: bold; color: white; text-decoration: none;
        }
        .navbar-brand i { margin-left: 8px; }
        .cart-toggle-button {
            background: none; border: none; font-size: 1.5em; color: white;
            cursor: pointer; position: relative; padding: 5px;
        }
        .cart-toggle-button .cart-count-badge {
            position: absolute; top: -5px; right: -10px; background-color: #ffffff;
            color: #4a3b31; font-size: 0.6em; padding: 3px 6px;
            border-radius: 50%; font-weight: bold;
        }
        .container {
            max-width: 1100px;
            margin-left: auto; /* لضمان التوسيط */
            margin-right: auto; /* لضمان التوسيط */
            padding-left: 15px;
            padding-right: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        h1.page-title { font-size: 2em; color: #982f34; text-align: center; margin-bottom: 25px; }

        /* --- Search and View Controls --- */
        .search-and-view-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-container {
            position: relative;
            flex-grow: 1;
            max-width: 400px;
        }

        #search-input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 1px solid #e0c4a0;
            border-radius: 25px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.95em;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        #search-input:focus {
            border-color: #982f34;
            box-shadow: 0 0 0 2px rgba(192, 57, 43, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
            font-size: 1.1em;
        }

        .view-toggle-btn {
            background-color: #fff;
            color: #8c533e;
            border: 1px solid #e0c4a0;
            padding: 9px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 40px;
        }

        .view-toggle-btn:hover {
            background-color: #e0c4a0;
            color: #4a3b31;
            transform: translateY(-1px);
        }
        .view-toggle-btn.active-compact-view {
            background-color: #982f34;
            color: white;
            border-color: #982f34;
        }

        /* --- Filters Styling (Horizontal Scroll) --- */
        .filters-container-wrapper {
            overflow-x: auto;
            padding-bottom: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid #e0c4a0;
            -webkit-overflow-scrolling: touch;
        }
        .filters-container-wrapper::-webkit-scrollbar {
            height: 5px;
        }
        .filters-container-wrapper::-webkit-scrollbar-thumb {
            background: #982f34;
            border-radius: 10px;
        }
        .filters-container-wrapper::-webkit-scrollbar-track {
            background: #f0e6d8;
        }

        .filters-container {
            display: flex;
            flex-wrap: nowrap;
            gap: 8px;
            padding-bottom: 5px;
        }
        .filter-btn {
            background-color: #fff; color: #8c533e; border: 1px solid #e0c4a0;
            padding: 8px 18px; border-radius: 20px; cursor: pointer;
            font-size: 0.95em; font-family: 'Cairo', sans-serif;
            transition: background-color 0.3s, color 0.3s, transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            white-space: nowrap;
            flex-shrink: 0;
        }
        .filter-btn:hover {
            background-color: #e0c4a0; color: #4a3b31; transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .filter-btn.active {
            background-color: #982f34; color: white; border-color: #982f34;
            font-weight: bold; box-shadow: 0 1px 3px rgba(0,0,0,0.15);
        }

        /* --- Category Sections --- */
        .category-section { margin-bottom: 40px; }
        .category-title {
            font-size: 1.8em; color: #8c533e; border-bottom: 2px solid #e0c4a0;
            padding-bottom: 10px; margin-bottom: 25px; text-align: right;
        }
        @media (max-width: 599px) {
            .category-title { font-size: 1.5em; padding-bottom: 8px; margin-bottom: 20px; }
            .filter-btn { padding: 7px 15px; font-size: 0.9em; }
            .search-and-view-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .search-container {
                max-width: 100%;
            }
            .view-toggle-btn {
                align-self: flex-end;
            }
        }

        /* --- Product Grid & Cards --- */
        .products-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
            gap: 18px;
        }
        .product-card {
            background-color: #fff; border: 1px solid #e0e0e0;
            border-radius: 8px; padding: 15px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            text-align: center; display: flex; flex-direction: column; cursor: default;
        }
        .product-card:hover { transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.09); }
        .product-card img {
            width: 100%; height: 300px; object-fit: cover;
            margin-bottom: 10px; border-radius: 5px;
            transition: height 0.3s ease;
        }
        .product-card h3 {
            margin-top: 0; margin-bottom: 8px; font-size: 1.05em; color: #4a3b31;
            flex-grow: 1; line-height: 1.3;
            transition: font-size 0.3s ease;
        }
        .product-description {
            font-size: 0.8em; color: #777; margin-bottom: 10px; line-height: 1.4;
            min-height: 38px; display: -webkit-box; -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;  overflow: hidden;
            transition: font-size 0.3s ease, min-height 0.3s ease, -webkit-line-clamp 0.3s ease;
        }
        .product-card .price { font-size: 0.95em; margin-bottom: 10px; font-weight:bold; color:#27ae60;}
        .product-card .customize-btn,
        .product-card .direct-add-btn {
            background-color: #982f34; color: white; border: none;
            padding: 9px 12px; font-size: 0.9em;
            border-radius: 6px; cursor: pointer;
            transition: background-color 0.3s, padding 0.3s ease, font-size 0.3s ease;
            width: 100%; margin-top: auto;
        }
        .product-card .customize-btn:hover,
        .product-card .direct-add-btn:hover { background-color: #d35400; }
        .product-card .customize-btn i,
        .product-card .direct-add-btn i { margin-right: 6px; }

        /* --- Compact View Styles --- */
        body.compact-view .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        body.compact-view .product-card {
            padding: 10px;
        }
        body.compact-view .product-card img {
            height: 160px;
            margin-bottom: 8px;
        }
        body.compact-view .product-card h3 {
            font-size: 0.95em;
            margin-bottom: 5px;
        }
        body.compact-view .product-description {
            font-size: 0.75em;
            min-height: 30px;
            -webkit-line-clamp: 2;
            margin-bottom: 8px;
        }
        body.compact-view .product-card .price {
            font-size: 0.85em;
            margin-bottom: 8px;
        }
        body.compact-view .product-card .customize-btn,
        body.compact-view .product-card .direct-add-btn {
            padding: 7px 10px;
            font-size: 0.8em;
        }


        /* --- Modal Styling --- */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background-color: rgba(0,0,0,0.6);
            z-index: 1001; justify-content: center; align-items: center;
        }
        .modal-overlay.active { display: flex; }
        .modal-content {
            background-color: #fff; padding: 20px; border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            width: 90%; max-width: 500px; max-height: 85vh;
            overflow-y: auto; position: relative; animation: fadeInModal 0.3s ease-out;
        }
        .modal-close-btn {
            position: absolute; top: 10px; left: 10px;
            background: none; border: none; font-size: 1.8em;
            color: #7f8c8d; cursor: pointer; line-height: 1; padding: 5px;
        }
        .modal-product-image {
            width: 100%; max-height: 200px; object-fit: cover;
            border-radius: 6px; margin-bottom: 15px;
        }
        .modal-product-title { font-size: 1.5em; color: #982f34; margin-bottom: 8px; text-align: center; }
        .modal-product-base-price { font-size: 1.1em; color: #4a3b31; text-align: center; margin-bottom: 5px; }
        .modal-current-item-price {
            font-size: 1.3em; color: #982f34; font-weight: bold;
            text-align: center; margin-bottom: 15px; margin-top: 5px;
        }
        .modal-customizations .option-group { margin-bottom: 15px; }
        .modal-customizations .option-group legend {
            font-weight: bold; margin-bottom: 8px; color: #982f34; font-size: 1.05em;
        }
        .modal-customizations .option-item { display: block; margin-bottom: 6px; font-size: 0.95em; }
        .modal-customizations .option-item label { margin-right: 6px; cursor: pointer; }
        .modal-customizations .option-item input { margin-left: 8px; vertical-align: middle; }
        .modal-quantity-controls {
            display: flex; justify-content: center; align-items: center; margin: 20px 0;
        }
        .modal-quantity-controls input[type="number"] {
            width: 60px; padding: 8px; text-align: center;
            border: 1px solid #ccc; border-radius: 5px; font-size: 1em; margin: 0 8px;
        }
        .modal-add-to-cart-btn {
            background-color: #982f34; color: white; border: none; padding: 12px 20px;
            text-align: center; display: block; width: 100%;
            font-size: 1.1em; border-radius: 6px; cursor: pointer;
            transition: background-color 0.3s;
        }
        .modal-add-to-cart-btn:hover { background-color: #d35400; }
        .modal-add-to-cart-btn i { margin-left: 8px; }

        /* --- Cart Sidebar (Responsive) --- */
        .cart-sidebar {
            position: fixed; top: 0; right: -100%; width: 100%; height: 100%;
            background-color: #fffefb; box-shadow: -2px 0 5px rgba(0,0,0,0.1);
            padding: 20px; box-sizing: border-box; transition: right 0.3s ease-in-out;
            z-index: 1002; display: flex; flex-direction: column;
        }
        .cart-sidebar.open { right: 0; }
        .cart-sidebar-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 15px;
            flex-shrink: 0;
        }
        .cart-sidebar-header h2 { margin: 0; font-size: 1.4em; color: #982f34;}
        .close-cart-btn-sidebar { background: none; border: none; font-size: 1.8em; cursor: pointer; color: #7f8c8d; padding:5px; }
        .cart-items-list-container {
            flex-grow: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; padding-bottom: 10px;
        }
        .cart-items-list { list-style-type: none; padding: 0; }
        .cart-items-list li {
            padding: 12px 0; border-bottom: 1px dashed #ddd; display: flex;
            justify-content: space-between; align-items: flex-start; font-size: 0.95em;
        }
        .cart-items-list li:last-child { border-bottom: none; }
        .cart-item-details { flex-grow: 1; margin-right: 10px; }
        .cart-item-details .item-name { font-weight: bold; font-size: 1em; }
        .cart-item-details .item-customizations { font-size: 0.8em; color: #555; margin-top: 4px; }
        .cart-item-details .item-customizations div { margin-bottom: 2px; }
        .cart-item-details .item-qty-price { font-size: 0.85em; color: #4a3b31; margin-top: 6px; }
        .cart-item-actions { display: flex; flex-direction: column; align-items: flex-end; flex-shrink: 0; }
        .cart-item-actions .item-total-price { font-weight: bold; margin-bottom: 6px; font-size: 1em; }
        .remove-item-btn {
            background-color: #982f34 !important; color: white; border: none; padding: 5px 8px !important;
            font-size: 0.8em !important; border-radius: 4px; cursor: pointer;
        }
        .cart-sidebar-footer {
            border-top: 1px solid #eee; padding-top: 15px; flex-shrink: 0;
        }
        .delivery-options { margin-bottom: 12px; text-align: center; }
        .delivery-options label { margin: 0 8px; cursor: pointer; font-size: 0.9em;}
        .delivery-options input[type="radio"] { margin-left: 4px; transform: scale(0.9); vertical-align: middle; }
        .cart-sidebar-footer textarea {
            width: 100%; padding: 8px; margin-bottom: 12px; border: 1px solid #ccc;
            border-radius: 5px; box-sizing: border-box; min-height: 60px; resize: vertical;
            font-family: 'Cairo', sans-serif; font-size: 0.9em;
        }
        .summary-line { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.95em; }
        .summary-line.vat-line { font-size: 0.85em; color: #555; }
        .summary-line.total { font-weight: bold; font-size: 1.2em; color: #982f34; margin-top:8px;}
        .cart-actions { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
        .checkout-btn-whatsapp {
            width: 100%; background-color: #25D366; color: white; border: none;
            padding: 12px 18px; font-size: 1em; border-radius: 6px;
        }
        .clear-cart-btn {
            width: 100%; background-color: #95a5a6; color: white; font-size: 0.9em;
            padding: 8px 12px; border-radius: 6px;
        }
        #empty-cart-message { text-align: center; color: #7f8c8d; font-size: 1em; padding: 15px; }

        .page-overlay {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);
            z-index: 1001;
        }
        .page-overlay.active { display: block; }

        .notification-toast {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background-color: #982f34; color: white; padding: 15px 25px; border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 1003;
            opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, bottom 0.3s ease; font-size: 1em;
        }
        .notification-toast.show { opacity: 1; visibility: visible; bottom: 30px; }
        .notification-toast i { margin-right: 8px; }

        /* --- Footer Styling --- */
        .site-footer {
            background-color: #000000;
            color: #fffaf0;
            padding: 40px 0 20px 0;
            text-align: center;
            margin-top: 50px;
            border-top: 5px solid #982f34;
        }
        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: flex-start;
            gap: 30px;
            margin-bottom: 30px;
        }
        .footer-logo-area,
        .footer-contact-info,
        .footer-social-links {
            flex: 1;
            min-width: 250px;
            padding: 0 15px;
        }
        .footer-logo-img {
            max-width: 150px;
            margin-bottom: 10px;
        }
        .footer-restaurant-name {
            font-size: 1.8em;
            color: #982f34;
            margin-top: 0;
            margin-bottom: 5px;
        }
        .footer-tagline {
            font-size: 0.95em;
            color: #e0c4a0;
            margin-bottom: 20px;
        }
        .footer-contact-info h4,
        .footer-social-links h4 {
            font-size: 1.2em;
            color: #982f34;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px solid #6b5b4f;
            display: inline-block;
        }
        .footer-contact-info p {
            font-size: 0.9em;
            margin-bottom: 8px;
            line-height: 1.7;
            color: #e0e0e0;
        }
        .footer-contact-info p i {
            margin-left: 8px;
            color: #982f34;
            width: 20px;
        }
        .footer-social-links a {
            color: #fffaf0;
            font-size: 1.5em;
            margin: 0 10px;
            transition: color 0.3s ease, transform 0.2s ease;
            display: inline-block;
        }
        .footer-social-links a:hover {
            color: #982f34;
            transform: translateY(-2px);
        }
        .footer-bottom {
            border-top: 1px solid #6b5b4f;
            padding-top: 20px;
            font-size: 0.85em;
            color: #e0c4a0;
        }

        @media (max-width: 768px) {
            .footer-content {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .footer-logo-area,
            .footer-contact-info,
            .footer-social-links {
                min-width: 100%;
                margin-bottom: 25px;
            }
            .footer-contact-info h4,
            .footer-social-links h4 {
                display: block;
            }
        }
        @media (min-width: 600px) {
            .products-grid {
                 grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
                 gap: 20px;
            }
            .product-card img { height: 150px; }
            .product-card h3 { font-size: 1.15em; }
            .product-description { font-size: 0.85em; min-height: 40px; }
            .product-card .price { font-size: 1.05em; }
            .product-card .customize-btn, .product-card .direct-add-btn { font-size: 0.95em; padding: 10px 15px;}

            /* Compact view for larger screens */
            body.compact-view .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
            body.compact-view .product-card img {
                height: 110px;
            }
            body.compact-view .product-card h3 {
                font-size: 1em;
            }

            .cart-sidebar { width: 400px; right: -420px; }
            .cart-sidebar.open { right: 0; }
            .cart-sidebar-header h2 { font-size: 1.6em; }
            .cart-items-list li { font-size: 1em; }
            .cart-item-details .item-name { font-size: 1.1em; }
            .cart-item-details .item-customizations { font-size: 0.85em; }
            .cart-item-details .item-qty-price { font-size: 0.9em; }
            .cart-item-actions .item-total-price { font-size: 1.05em; }
            .remove-item-btn { font-size: 0.85em !important; padding: 6px 10px !important;}
            .delivery-options label { font-size: 1em; }
            .delivery-options input[type="radio"] { transform: scale(1); }
            .cart-sidebar-footer textarea { font-size: 1em; min-height: 70px; padding: 10px;}
            .summary-line { font-size: 1em; }
            .summary-line.total { font-size: 1.3em; }
            .checkout-btn-whatsapp { font-size: 1.1em; padding: 14px 20px; }
            .clear-cart-btn { font-size: 1em; padding: 10px 15px; }
        }
        @keyframes fadeInModal {
            from { opacity: 0; transform: scale(0.95) translateY(-10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
    </style>
</head>
<body>
    <div class="modal-overlay" id="customization-modal-overlay">
        <div class="modal-content" id="customization-modal-content">
            <button class="modal-close-btn" id="modal-close-btn">×</button>
            <img src="" alt="Product Image" class="modal-product-image" id="modal-product-image">
            <h2 class="modal-product-title" id="modal-product-title"></h2>
            <p class="modal-product-base-price" id="modal-product-base-price"></p>
            <p class="modal-current-item-price" id="modal-current-item-price"></p>
            <div class="modal-customizations" id="modal-customizations-container"></div>
            <div class="modal-quantity-controls">
                <input type="number" id="modal-quantity" value="1" min="1" aria-label="الكمية">
            </div>
            <button class="modal-add-to-cart-btn" id="modal-add-to-cart-btn">
                أضف للطلبات <i class="fas fa-cart-plus"></i>
            </button>
        </div>
    </div>

    <div class="page-overlay" id="page-overlay"></div>

    <nav class="navbar">
        <a href="#" class="navbar-brand">مطعم ألتا<i class="fas fa-utensils"></i></a>
        <button class="cart-toggle-button" id="cart-toggle-btn" aria-label="فتح سلة التسوق">
            <i class="fas fa-shopping-basket"></i>
            <span class="cart-count-badge" id="cart-count-badge">0</span>
        </button>
    </nav>

    <div class="container">

             
               <div style="text-align: center;">
  <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2BYkvJbxm5pmtCS5a5O4LdBKX5k00W8vaQxzUSjfSsfhYeNYXJ2B1B8Ozh4nTTnIM2jmMhh5K_puUav4A75895Sz9sMpQWHC-_GyrcJLL_cBga7K9gGedW45yyzLHlETOQ8CKBUO-IxpJeddZCp1UqwRr5GwQ_TByKWgCqarUu3n-4ofnoNORz_vnbNO8/s317/WhatsApp%20Image%201010-05-23%20at%208.11.27%20PM.png" alt="تم تصميم هذا المنيو بواسطة فريق حاجب سوفت:0510012621" title="تم تصميم هذا المنيو بواسطة فريق حاجب سوفت:0510012621">
</div>
        <h1 class="page-title">قائمة الطعام </h1>

        <div class="search-and-view-controls">
            <div class="search-container">
                <input type="text" id="search-input" placeholder="ابحث عن وجبتك المفضلة...">
                <i class="fas fa-search search-icon"></i>
            </div>
            <button id="toggle-view-btn" class="view-toggle-btn" title="تغيير طريقة العرض">
                <i class="fas fa-th-large"></i>
            </button>
        </div>

        <div class="filters-container-wrapper">
            <div class="filters-container" id="filters-container">
                <!-- أزرار الفلاتر ستُضاف هنا بواسطة JavaScript -->
            </div>
        </div>

        <div id="menu-sections">
            <!-- أقسام التصنيفات والمنتجات ستُضاف هنا -->
        </div>
    </div>

    <aside class="cart-sidebar" id="cart-sidebar">
        <div class="cart-sidebar-header">
            <h2>طلباتك</h2>
            <button class="close-cart-btn-sidebar" id="close-cart-btn-sidebar" aria-label="إغلاق السلة">×</button>
        </div>
        <div class="cart-items-list-container">
            <ul id="cart-items-list" class="cart-items-list">
                <li id="empty-cart-message">سلة الطلبات فارغة.</li>
            </ul>
        </div>
        <div class="cart-sidebar-footer">
            <div class="delivery-options">
                <label><input type="radio" name="deliveryType" value="pickup" checked> استلام من المطعم</label>
                <label><input type="radio" name="deliveryType" value="delivery"> توصيل للمنزل</label>
            </div>
            <textarea id="general-order-notes" placeholder="ملاحظات إضافية على الطلب"></textarea>

            <div class="summary-line">
                <span>المجموع الفرعي (شامل الضريبة):</span>
                <span id="cart-subtotal-amount">0</span> ريال
            </div>
            <div class="summary-line vat-line" id="vat-line-details" style="display: none;">
                <span>ضريبة القيمة المضافة (15%):</span>
                <span id="cart-vat-amount">0</span> ريال
            </div>

            <div class="summary-line" id="delivery-fee-line" style="display: none;">
                <span>رسوم التوصيل:</span>
                <span id="delivery-fee-amount">0</span> ريال
            </div>
            <div class="summary-line total">
                <span>الإجمالي الكلي:</span>
                <span id="cart-grand-total-amount">0</span> ريال
            </div>
            <div class="cart-actions">
                <button class="checkout-btn-whatsapp" id="checkout-btn">
                    إرسال الطلب عبر واتساب
                </button>
                <button class="clear-cart-btn" id="clear-cart-btn">
                    إفراغ السلة <i class="fas fa-times-circle"></i>
                </button>
            </div>
        </div>
    </aside>

    <div class="notification-toast" id="notification-toast">
        <i class="fas fa-bell"></i> <span id="notification-message"></span>
    </div>

    <!-- ===== Footer Section ===== -->
    <footer class="site-footer">
        <div class="footer-content container">
            <div class="footer-logo-area">
               <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2BYkvJbxm5pmtCS5a5O4LdBKX5k00W8vaQxzUSjfSsfhYeNYXJ2B1B8Ozh4nTTnIM2jmMhh5K_puUav4A75895Sz9sMpQWHC-_GyrcJLL_cBga7K9gGedW45yyzLHlETOQ8CKBUO-IxpJeddZCp1UqwRr5GwQ_TByKWgCqarUu3n-4ofnoNORz_vnbNO8/s317/WhatsApp%20Image%201010-05-23%20at%208.11.27%20PM.png" alt="شعار المطعم" class="footer-logo-img"> 
                <h3 class="footer-restaurant-name">مطعم ألتا</h3>
                
            </div>
            <div class="footer-contact-info">
                <h4>تواصل معنا:</h4>
                <p><i class="fas fa-map-marker-alt"></i> المنتزة الغربي - طريق الملك سلمان بن عبد العزيز</p>
                <p><i class="fas fa-phone-alt"></i> جوال :0508777878</p>
 
            </div>
           
        </div>
        <div class="footer-bottom">
            <p>© <span id="current-year"></span> جميع الحقوق محفوظة لحاجب سوفت .</p>
        </div>
    </footer>
    <!-- ===== End Footer Section ===== -->

    <script>
        const deliveryFee = 10;
        const CART_STORAGE_KEY = 'restaurantAppCart_vFinalCompleteWithFooterFixed';
        const VAT_RATE = 0.15;
        const COMPACT_VIEW_STORAGE_KEY = 'restaurantApp_compactView'; // لتخزين تفضيل العرض

        const productsData = [
    {
        "id": "2MLPAA",
        "name": "برجر ميبل",
        "category": "برجر",
        "description": "880 سعرة حرارية",
        "basePrice": 15,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtHwCIw2IxRDTkgpEMxck8qntgiPFoOfB5M1eWUCAJG1JsplRTIWFdGypNqEGEOJTjEtuOw3kWrFb1DGaflb24FXVlZuQSozSBkGXwzMPIk1s3ysbQ8O19vOx5qPFWK6OnKrtJIKjsDtgmFj9YMTn5Gb2JZBVVQXo0uudCFZM-Va3ui_ZrWM9NXYwZ0VXg/s1600/WhatsApp%20Image%202025-05-23%20at%206.34.53%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "ESLWZE",
        "name": "وجبة برجر ميبل",
        "category": "برجر",
        "description": "1020سعرة حرارية",
        "basePrice": 18,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjcCsIvVN0db1Z61gtpbHnCW0C00twNpSSK2cQXHRNHsfQB6tMvVolzH2a31YnRb4APnSAfAZS42OXf8eoAaBt8oYlUzqMHDPO_1YpXfsNJkVQZb3HrR68Bg4em4mkUccDOFiV-k16kOfuO5Zxs_6b2iTQnWDVvDBvoijlIsrNiozCkaSaEx_c0VbX4sZjz/s1280/WhatsApp%20Image%202025-05-23%20at%206.35.03%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "X0YGG1",
        "name": "وجبة كريسبي زنجر",
        "category": "برجر",
        "description": "1100 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgUQJzfTyHwkCFSd4aeFV1e3Zp7eHUhA8qFzmXdpHf0H5m6x0D4wXCLbq8LA9L88MPD1VEkiU8lI08tBcZ5vCpFPziGgZhZrQfU9uk4fxPeBIfALWZ-qnMJ9WplpL4v38EVMiJGq2eFXMvigUtgkfDqFZXYZcL0TUVuw3vf-YzlIBnhptbDjb4weeOuMH88/s1280/WhatsApp%20Image%202025-05-23%20at%206.36.48%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "LB70OF",
        "name": "كريسبي زنجر",
        "category": "برجر",
        "description": "960 سعرة حرارية",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEij825ToWa5JZFxYfQU2PnfRXagUn54b8rv0xDaNlYPT2SYS7gYOt_X9hwD1ddTYIYE_vIhjKWwQKWExIiVhYebWs8xXLwpwkVhQo-qyqSW7oMPPL1twY-GphfPXU6zBeLtAIISituA-n9w7KXHqYIlaVAp9GjRg_4LTq2BByVRWBg4ucc-mFuG_74rJ9oT/s1280/WhatsApp%20Image%202025-05-23%20at%206.37.14%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "6VHHC4",
        "name": "سويت شيلي",
        "category": "برجر",
        "description": "980 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwHUlgmheUJ2oW_cuXgu3-S1MIcM54ZfH4vc_nBJfStATtdf_eOt7gPvF619Qtvvpl2vcK_S2TlDItoN_ERCXPw-o5HJUbGxoyZKwI3EX7T8DUXfQMOke7Z4IpZsgfqLq6aosgGOpYPJkwILdk_3Qb9-ZxXcj7T0TXyc4az5UzmGGPiAsqrcti944KOy6k/s1280/WhatsApp%20Image%202025-05-23%20at%206.39.05%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "4AE3D5",
        "name": "وجبة سويت شيلي",
        "category": "برجر",
        "description": "1120 سعرة حرارية",
        "basePrice": 19,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSmFWzbycrHO-rwo6yRU24a8D1DOUUXzcl_ZyO1ownJxHh-2_OAY0ubimwnR9hfEQKVOT5YGjIKmlvt0Vi8lY0yB0ugBA_8fii7BYiLvNbMBOHvRia1hSFODuAY3lhuyVrieVMe71I3P5Yd3LZRCYF-kdVPp65HPlTOBbnkf2wpgjiq80-bUbWiZAdmop0/s1280/WhatsApp%20Image%202025-05-23%20at%206.39.30%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "VBRN2T",
        "name": "تشيكن برجر",
        "category": "برجر",
        "description": "700 سعرة حرارية",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7tUNqLfaQ0batTuJvSvk5BA7ELy2AksQc-pvIb16zFF4wwIyEBbCExyrVMYn1rAn5yeciNeKtNlYHi9hoJLAdnmny-HaHTdUsrMT6pLBUHFcvnzlMmQ0aT_BUleQtM2NtO0eRbxQEpHhQ4dfLAxgAfWxltyxDXpAdd1Aoa2kdsaJ5ClAmjdHEL2aux4pQ/s1280/WhatsApp%20Image%202025-05-23%20at%206.40.44%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "XV97GI",
        "name": "وجبة تشيكن برجر",
        "category": "برجر",
        "description": "840 سعرة حرارية",
        "basePrice": 13,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjjF6XHPtiiy-VPKwcNG4kfizQ3XCWg1ZWmPJw5qdRWXlBl8sPwnZ3qNHY9CYuYKDefEjheqebm40crS5lXhhiUAZc75qpZDM_pB2qKGgQoF5Jb6wGvcxS2PYvxFQi187C0EuwpqEoFKOREbAfZadicxuFh6LR39XOZFfLuwNpSBjq96UkeJYalG5qzsHY2/s1280/WhatsApp%20Image%202025-05-23%20at%206.41.08%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "R6BDF3",
        "name": "وجبة مايتي زنجر",
        "category": "زنجر",
        "description": "1180 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnHTr5VDN6WK3YV-2uckes6ORzQkzNWtbmneYZOgiVs-rBb1dPs4kCe98OyM4yxNZOX7Ql7vxXWfaaDsjm7YKOm-z_jV43pJzqsjcqXhfkTh2NKHBqfmBuaBgckgU3a3gpycxmbuznJC0hlQkjyRnQskyYaGxBnmfFqo_ifBucDGBtFTQFnWH-0mrkPhZ6/s1280/WhatsApp%20Image%202025-05-23%20at%206.42.36%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "VYB37A",
        "name": "مايتي زنجر",
        "category": "زنجر",
        "description": "",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0pCrOxRcp1Rq5_GP8FJwpirGSGVLzBmg32fAxmZr9GTChZSx9f6Xj20MhHnDXtGl_22G6J4Quv1EA6vkC1paBivFbiO1WaDmztCTxzK1V-AEynXUKISujWhk512PIB6HtIzFmm5xgmveVlIV6HT9f_uTDJLJnwiRCzToYLz75tzMZZr8kSyiY8dv0Yj88/s1280/WhatsApp%20Image%202025-05-23%20at%206.42.53%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "UJC44L",
        "name": "سوبر كرانشي",
        "category": "ساندويتشات",
        "description": "900 سعرة حرارية",
        "basePrice": 12,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEitG5jkGhlq8FaWy7OduD2TusP_FwzuQ3i4a_Qu7BfWLDk1D25fqS_1MiSF-0LStYcy2ZdLxSHpW2lMvSV9Mx45qZIRQVywYEvVQhkw_iDaD-OJJikMbEDtX57boy6g7XLmQNl2rwNdQRfTTyK1Yz9chmoUe5mmQTFImUmrTeMdRSALbVALinpL4QpWD2SP/s1280/WhatsApp%20Image%202025-05-23%20at%206.43.42%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "S95MSO",
        "name": "وجبة سوبر كرانشي",
        "category": "ساندويتشات",
        "description": "1040 سعرة حرارية",
        "basePrice": 16,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgE6qxDp6V0aHqfLLylcppn1X53_laqr5ZPBbhAkpT-TGAUjUPYPzDxf98PadKx6y-lN1Q3aDdPIZNHo96iH4_fqE8Dy1B6qb_8O9bgfbdA1pz63MyXx_mQmkmiRixl66NuKOpgYpUz6niKFqZAquWFqgDDzsMZQTpughGWXttvE6erQqMWCfYK-oQUP5i-/s1280/WhatsApp%20Image%202025-05-23%20at%206.44.14%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "WJ4V9V",
        "name": "كودو دجاج",
        "category": "ساندويتشات",
        "description": "380 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEI-H8kWeHBQNiPuJQvV9rKJNTgt_x0FjKuZRbWRlT_xFJ70zX9baSgLjP3ckicyIZXQTAkhdny3lGgCyHEogvionUwhozWPjhoryQFyhXrEuqOfzfRl9SrGT3PItnzLolMdkuU-XLbevA-17MgDeic8ICbyRzmWP1vRRdA3cQvbT7QI2_Rdhfc9iJ3MAS/s1280/WhatsApp%20Image%202025-05-23%20at%206.45.26%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "DBCCCV",
        "name": "وجبة كودو دجاج",
        "category": "ساندويتشات",
        "description": "520 سعرة حرارية",
        "basePrice": 20,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0Db_GXCUUjHynJxRK83wsIf8drKz9vC-5dwaopHCGF3cyAtnUT_i6hJSusCEFGKRT8jDHb2R4SiiIa5frFn4QLAcZPDz_7GaFjVNYcjKOzTqh0Sr3YAkTq4cIp6IyMyv8ynu9tPD2HDRUyz5kHfvZQxPJat0vQRTfVnNlBBv60xEJNwN9v5K_8po0bQ6t/s1280/WhatsApp%20Image%202025-05-23%20at%206.45.54%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "6A8F0B",
        "name": "وجبة تشيكن باربيكيو",
        "category": "ساندويتشات",
        "description": "620 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQSHt4rBY1WVzMJctUrhVNV8NjDmUlyNj4iAHkdX22M11oK0dyDfPeAU9cwDgfNJf6WQVd0lHY-xHcg-8puzhhyphenhyphenuGDU1RBOhDDPvTPvD0NnLJfeThbzKwNeQ0IbVtCRE1RK1qyD7fj0DRfg5OsHcPwbzvCThf9sptr8d_d_jC2G_X-UXiIIz1aV1oJE3ll/s1280/WhatsApp%20Image%202025-05-23%20at%206.53.07%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "R31ES5",
        "name": "تشيكن باربيكيو",
        "category": "ساندويتشات",
        "description": "480 سعرة حرارية",
        "basePrice": 13,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTs-Z6ysIw8Ji41KBxgz_xK_PzjtLtOl-l8163fNVo6w7Dhd0D8aMxN3P_SYkknLwlsSsXmULAPSJr6CjXlgYDwDJStI8_Jx1qx-1BW4aIITK_3-yel3fAm3nZRaQ3A7w0ZTXhewe8LIaTruvl8q7UW9x3UD-_dyrw3VBfVP15Ndi2qE2ou5YqBFUn2oai/s1280/WhatsApp%20Image%202025-05-23%20at%206.53.20%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "YBI46S",
        "name": "تشيكن راب",
        "category": "ساندويتشات",
        "description": "840 سعرة حرارية",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgXjWV44CRkjaXUpnvKGOM1HZkp_T0rWvnEp7r2Ny2MO-EB9D3BDpoGd1vbfjLW_JaJPv0td2c6F2cj2JA6YGFy9rlN6yx-18wlH_F_PmK3WD6Kieh65XyOcWxmgBmZEve9L8lWfCqTUpeyX65CNrPn7-NZWpDjwHIUkcchJSJsLJeWee5j3ljWpd0b2sXq/s1280/WhatsApp%20Image%202025-05-23%20at%206.53.37%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "7VNZA0",
        "name": "وجبة تشيكن راب",
        "category": "ساندويتشات",
        "description": "980 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrgBECKnAGpokHhRBVdO7kCMdDGWElmXPVRKAWa9-JGSrIUVkKno5-O0GkQcMCE3R2Toh0HOvaP0oVsxeBWPny-L5N1U7ZFdSzn6TGlsgr0UkAOhPPW6BehiOnNFSh5hIWaflihTVXoWyhF0rWhOekLIBwx5LJoHepk1lbows69QlElaMY0-CNe7dNETsB/s1280/WhatsApp%20Image%202025-05-23%20at%206.53.48%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "L1D9XE",
        "name": "تشيكن راب حار",
        "category": "ساندويتشات",
        "description": "850 سعرة حرارية",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2reYKNiqoDcUtp1e6ohiRnelWWWuGOjzEDCSKL_KVzXdHdzB4BqRl6IptFRvqrJaH58jIQd0ZXl4RymLW-c4gc2gfAL0VoM5Uovr-6hZSF1OfuMb0tuFprPHAz5xTx3lCZJTmutOFmzp3-1mBSHMi5o-ASKBq00AhBHuqeasAb5e1lIgdsbJUqTcKP4_T/s1280/WhatsApp%20Image%202025-05-23%20at%206.54.58%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "V9S7HA",
        "name": "وجبة تشيكن راب حار",
        "category": "ساندويتشات",
        "description": "990 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifaGHLvCBW-pJnAm7vjizzbImHk1yqpJ8yxGcSarRhGajUYUdG1_YRuf8-B0r0hnx-Q0Y0aGzKk0bt6CSlf6Hro5Kguvexn7wv5WuTCi9iHSg5ZPFNZcOpsBLUJAemLNWM3d_JkmjxBtSt1pvkOMbJtr0AcsoTV-mlbj4Zw1D2DlOFTCbBq095Fg4ChG3a/s1280/WhatsApp%20Image%202025-05-23%20at%206.55.44%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "MYOQZ2",
        "name": "تشيكن تشيز",
        "category": "ساندويتشات",
        "description": "550 سعرة حرارية",
        "basePrice": 15,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEikuc3CzgFVnqcMOla09mfHtomNK9AG_r_KpnNeQN8exf9ilvzAXhmcbJF6vLqdMcIY3Bh6ZvRCEP1X5boZVyNEGIm0JEEdo9bTeoUOk-GY44ShcGvMqEQQheVUXotR-ODhMFCL9DnfqaKWcVtKnZOd8ecDRzBDUpcHCHVo9WcTPpqjmc8M71rp3qrHx4WY/s1280/WhatsApp%20Image%202025-05-23%20at%206.56.26%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "1YYU84",
        "name": "وجبة تشيكن تشيز",
        "category": "ساندويتشات",
        "description": "690 سعرة حرارية",
        "basePrice": 18,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmtedhCg4FiyZNydMAchLYH6WYbSS5mUGdXnRU2IBv2acY-s2fSfhZ3yr1PXIAlnVf_bvM8tLdfIlYiv2U9KquHOnMmsnpOXHjK3ZKqBNA-d0s9N0rwjVYUxZqjatBGOFk71g1UboRqbrJDbCZXciNsj75faEWWt7lmmz_MwwzCGozjIeTuPFusIiMtU6/s1280/WhatsApp%20Image%202025-05-23%20at%206.56.43%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "JM0P1D",
        "name": "بروستد عادي",
        "category": "بروستد",
        "description": "1640 سعرة حرارية",
        "basePrice": 17,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFwyOsobb2xODlVl3f9zn6FgmXs_af3zyZQ8fs6JtSC1mFaJG3GOww6jdLbZFc2RGVW6iItlZHVe0izDuKZs1gadYpcpR5uKptHVChwgCXA4cxdGmKDF1nCvI9X4erPpMbTKQ4ltwmkmlXb2FLiSr_F4OchnZGOb3jB24Vt7eQ3Aq2mM1IfeDX4kKyyJua/s1280/WhatsApp%20Image%202025-05-23%20at%207.00.00%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "JYHKBD",
        "name": "بروستد حار",
        "category": "بروستد",
        "description": "1700 سعرة حرارية",
        "basePrice": 19,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDD3KKDJmQNkXUHbZaX8SSxqmEuF4gMK2TukAWJfb6Zm3nWyodswMWUULQ4nm7G02-CmqZkRhMIYue7sdTfO0chfQLfgl4tmNZ9Vv15ZPJdW5lRpqQ3kck1sdkWRj4QGozmoyLycAOweOB3ZR2WV97ZU2YrZ8T9DnCPlFo4lBxaJOdkBP9t6Wdms8GpL-f/s1280/WhatsApp%20Image%202025-05-23%20at%207.00.16%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "3B7NG5",
        "name": "استربس عادي",
        "category": "بروستد",
        "description": "850 سعرة حرارية",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaoP6-JowrmOwYVeDfzwCdizwOMvGtArKcPFpllENuvXFHgMVpUHVeYMaqySaXweWT5j-ftDY8A5v46YHH_tuuTmkKeBVFld_0cF0N5HZXhZaZSCkk470Ve2wMfkM2CIMYc6nAYDd0yIftw4nCJDpU5lqye27mnC3V8PujcDzOnm7uD0FBc2ULvzWTSMrH/s1212/WhatsApp%20Image%202025-05-23%20at%207.00.57%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "AYX3TX",
        "name": "استربس حار",
        "category": "بروستد",
        "description": "910 سعرة حرارية",
        "basePrice": 14,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWMzZBCMzk1oE3aE8ydGZT3eBwoUQYSxK3E3MXW7l8F1HAmJfwm3eEZy0MbfGP4s7tlKjM-aknfgoLPKjvWBnEfmBDVD-ZAp9E34ipBRl4wYDuKUwL4LT_b9AX-Q6zPPoydcf1SzH31FuuOAq6BXqYTaUY-EDGe44aqYqcf1YU9r9uedMMxmIu2de1v3KD/s1212/WhatsApp%20Image%202025-05-23%20at%207.01.26%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "U0IAIP",
        "name": "بطاطس استربس",
        "category": "بطاطس",
        "description": "1070 سعرة حرارية",
        "basePrice": 13,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjecQB42EsxZHtrqmTVFXaYoZtuJU-9tPNPceysHpZ9lKYXluw9lRUsqgH01dTz_tKAhwo5tUmWigQGcLA0nEWhVjsMlhFojKANE4CxXXYTxU7C7lmC_gZr0ruCM7buG3uQ5WzoDk8HsPR9bkxkhZhWNUdFW5Ir7OXncvnWLGjDJRTN02UcutQk3rRTukZX/s1600/WhatsApp%20Image%202025-05-23%20at%207.02.43%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "8P7RYT",
        "name": "بطاطس",
        "category": "بطاطس",
        "description": "370 سعرة حرارية",
        "basePrice": 6,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy8awjMrQbLo-7fkYk3AvuQlrcaaJxN29Bw4XaLT9DBqb_ZbK37-NaO0OThuP3WEWmCJyBm8DVav9p5cC_rOEBwDIKdKWuOZ3dEw_w7wxyg2POerTfI2HmrIXQqs0YfqLuSyZu6vIQu7BNUMFw6IE1r1kAvRHdb4PgSWOoSVruFz4Id1fyOyxRh1YYjUyY/s1280/WhatsApp%20Image%202025-05-23%20at%207.02.56%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "MVGOXR",
        "name": "وجبة ناجتس",
        "category": "وجبات اطفال",
        "description": "760 سعرة حرارية",
        "basePrice": 13,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRJIMN0wfz_WJOUeygiiTxK092QOi8ZkkWYDGclUcUyEa24UrFxUC6uPEJpQ1a78np-nG9L94lpIprywQi9OPFG6ddEIzliIPdo0KX4_4CcVF64hfEcwqim1CsR_IYJxUMuuJPNDyeHe_SnoryKsbWnUaN5GV9oPKRuR50DJCU8adnQXTnH5vV4vy1-_Wd/s1280/WhatsApp%20Image%202025-05-23%20at%207.04.03%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "UVNRLK",
        "name": "وجبة برجر اطفال",
        "category": "وجبات اطفال",
        "description": "800 سعرة حرارية",
        "basePrice": 10,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiUGqhM9Aowr-9bAKMzatAWWa1FSyAcoVf_4rJkpH2U9n1kmOI4y44-DBAoiwWy1EXpF6bUwrQE9uPTxMpVzMNbGPqLn7fAAkahPh4tx_QpqTlrIHuYElS29E2ybmPRdUJbEUjEAyH08lpxg83ncbViblFRNjHL12mJ7DlsdWw24CSyDX44UF7WXLjzSib2/s452/WhatsApp%20Image%202025-05-23%20at%207.04.11%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "NQMEE0",
        "name": "صوص ثوم",
        "category": "صوصات",
        "description": "260 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhwmANRMN-p_jjY_s80CUqZNuIUkP8JnuL3BgXm9fW4wQML9aAMJ3ibb-qbw2tReYtTjsUbPDckTticG8d3jEGOZnK8fdHZCIiKJKlpjFiTZEjgKk9lXfNFCw1Zkrhzy_9aIB6Gz7GbvNrlAe02L1H5dJ_A5vWO2MeJDF1u34W_MAym1jc-8YWEJJSgqPJJ/s1280/WhatsApp%20Image%202025-05-23%20at%207.05.40%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "L3QDAV",
        "name": "صوص ثوم حار",
        "category": "صوصات",
        "description": "260 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh62XwUOcIQWkYY7McNpL2e02ayR2c-uHTmik3nUM9ywWnRa6qKmfRQU3M_QQM3b2ZMtR9GmWB8U_sxYOzKE3ZIpOfxKZsW334lqpuhE7egZXKjornwS7jagPwSFUD9wxjcEZUrCq9DZtudRgWaTskA170XpvJL-FGEv6ZhL3ZPXi1Lyd5cRnQZm_bh31EX/s1280/WhatsApp%20Image%202025-05-23%20at%207.05.56%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "2KPLJW",
        "name": "صوص ألتا",
        "category": "صوصات",
        "description": "150 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG2WAOrZKwQrXIs7SqHpWLFblcp89ZJYfL8kHWM5pqYl_jtA9dAk8oMHsObpDG8UtZTRZuhyphenhyphengx3745X0Dth7579JSS77xl-vjIl15B8-c4EecPE9R4qA9tHgpBp0YFVL04Af4rV5Vp1wC9elkr8OYut09SQAkyb5Usj-Hg2PxmpUUvyQR5bA4f3IvuuJB1/s1280/WhatsApp%20Image%202025-05-23%20at%207.06.44%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "TF96LY",
        "name": "صوص رانش",
        "category": "صوصات",
        "description": "150 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8P_ZYLLmz6vzhbaNx_qnjlcfWAJCZWx6sVNFzsP2bUdMQ4LQWa8FfTd3MpkE3Q13LcXfAQ9l3uhyoyKhTRsDBC33P-t6A0LEv-CnnjU4aHYiwTZJFFpAyZYS-7KlQcGbbBwdiW1w5gYcbpyWKmZ73vbqLR-E4rE7DgmeQb0RluKYdpk1Ada_wJDMEBa_m/s1280/WhatsApp%20Image%202025-05-23%20at%207.08.04%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "L586Z3",
        "name": "صوص راب",
        "category": "صوصات",
        "description": "120 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQkarr6nuO355T6Lh69uZPcOGlug-SPMn8IJgJ7HWxDL9ShIoxEBCqDWKkpYwlLEMVb_SjCoiIov0na8aiuY8ii60YHd7TkPybTnQaFMPEUF7tjpxubY6PNLy4GopQJDFxyB7wKC9MdeYcxLH2mKhh2FvDERluyEd0bN1uhDrl11F2TjoR56yXjKu68UTF/s1280/WhatsApp%20Image%202025-05-23%20at%207.08.13%20PM.jpeg",
        "customizations": []
    },
    {
        "id": "XZ61PO",
        "name": "ببسي",
        "category": "مشروبات",
        "description": "151 سعرة حرارية",
        "basePrice": 3,
        "image": "https://cdn.salla.sa/VqDPpK/TAHBgquz6EtxWAcKn2sVQwEKKhRYx9flbe8hvk1r.png",
        "customizations": []
    },
    {
        "id": "AVSKAS",
        "name": "ديو",
        "category": "مشروبات",
        "description": "158سعرة حرارية",
        "basePrice": 3,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqZet1cv0e4zhyphenhyphenUND79ffrDpQsS8hxuV247VgV1Ix8922V8tJdPOCjaXTccHsuMn2T6wnwtQImRuY29ogZqu56SS2UxwEfDtboA3x3BFJ_r6B90z1vLTsX7d6aObdVvrPdHu3qAny52dPjKYkVNo7aAt3zX0KUHM4vNGPJzk9MflKMZ5o9u1zvVut-5y2H/s480/a91beefe-984c-4122-beb5-497af7e1dc58.jpg",
        "customizations": []
    },
    {
        "id": "1K35BT",
        "name": "سفن اب",
        "category": "مشروبات",
        "description": "158سعرة حرارية",
        "basePrice": 3,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqZet1cv0e4zhyphenhyphenUND79ffrDpQsS8hxuV247VgV1Ix8922V8tJdPOCjaXTccHsuMn2T6wnwtQImRuY29ogZqu56SS2UxwEfDtboA3x3BFJ_r6B90z1vLTsX7d6aObdVvrPdHu3qAny52dPjKYkVNo7aAt3zX0KUHM4vNGPJzk9MflKMZ5o9u1zvVut-5y2H/s480/a91beefe-984c-4122-beb5-497af7e1dc58.jpg",
        "customizations": []
    },
    {
        "id": "ED38O4",
        "name": "حمضيات",
        "category": "مشروبات",
        "description": "172 سعرة حرارية",
        "basePrice": 3,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgbeCmcLiqhCXRVA1AdkGsgJzuVgKPADgTWYbvceYTHiIhc0oWYA02BlZRuE2iVeIDzs5JdWi1dCbTy6P8IvJpdCsJaf_Iw8ThY7fzXCAYJaG5ZSFQwPpHNmGgRXNTGl2HELgN4sXBbBGkQon7VfvZvXfI0wQQYjMrNBtvyz4aTKZ4kNN3FnVD3qEnNV2BQ/s1690/bf88d184-d280-4ea7-9331-9e3669ef0337.jfif",
        "customizations": []
    },
    {
        "id": "PUSYR5",
        "name": "ماء",
        "category": "مشروبات",
        "description": "0 سعرة حرارية",
        "basePrice": 1,
        "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBmmLUJN_SCjNfuk-CuMj3RypxhSgMkZuj6k_4XaHEzZclNtdlcvrQigmFmc22kKGDjS8dDskuXlueuCPvf6zgbyjY0wtZess5JBl_ZThDXZALqL_w_kbaRp5AkzG2VME6RlQtlQuOBZeUid19N53rdRC7Yko6bLjuA8Ev8xzPhZmUtynvq6sFrHjF09lj/s1000/l51CsNfkmRkT1RtSN3NaD33wqMWV1FZKmjUcysRr.webp",
        "customizations": []
    }
];

        // DOM Elements
        const modalOverlay = document.getElementById('customization-modal-overlay');
        const modalContent = document.getElementById('customization-modal-content');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const modalProductImage = document.getElementById('modal-product-image');
        const modalProductTitle = document.getElementById('modal-product-title');
        const modalProductBasePrice = document.getElementById('modal-product-base-price');
        const modalCurrentItemPrice = document.getElementById('modal-current-item-price');
        const modalCustomizationsContainer = document.getElementById('modal-customizations-container');
        const modalQuantityInput = document.getElementById('modal-quantity');
        const modalAddToCartBtn = document.getElementById('modal-add-to-cart-btn');

        const menuSectionsContainer = document.getElementById('menu-sections');
        const filtersContainer = document.getElementById('filters-container');
        const cartItemsListElement = document.getElementById('cart-items-list');
        const cartSubtotalAmountElement = document.getElementById('cart-subtotal-amount');
        const cartVatAmountElement = document.getElementById('cart-vat-amount');
        const deliveryFeeLineElement = document.getElementById('delivery-fee-line');
        const deliveryFeeAmountElement = document.getElementById('delivery-fee-amount');
        const cartGrandTotalAmountElement = document.getElementById('cart-grand-total-amount');
        const checkoutBtn = document.getElementById('checkout-btn');
        const emptyCartMessage = document.getElementById('empty-cart-message');
        const cartToggleButton = document.getElementById('cart-toggle-btn');
        const closeCartButtonSidebar = document.getElementById('close-cart-btn-sidebar');
        const cartSidebar = document.getElementById('cart-sidebar');
        const pageOverlay = document.getElementById('page-overlay');
        const cartCountBadge = document.getElementById('cart-count-badge');
        const clearCartBtn = document.getElementById('clear-cart-btn');
        const notificationToast = document.getElementById('notification-toast');
        const notificationMessage = document.getElementById('notification-message');
        const generalOrderNotesTextarea = document.getElementById('general-order-notes');
        const deliveryTypeRadios = document.querySelectorAll('input[name="deliveryType"]');

        const searchInput = document.getElementById('search-input');
        const toggleViewBtn = document.getElementById('toggle-view-btn');


        let cart = [];
        let currentDeliveryType = 'pickup';
        let currentProductIdInModal = null;
        let currentProductInModalObject = null;
        let notificationTimeout;
        const whatsappNumber = "966508777878"; // !!! استبدل هذا برقمك الصحيح !!!
        let currentActiveFilter = 'all';
        let currentSearchTerm = '';
        let isCompactView = false;


        function saveCartToLocalStorage() {
            localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
        }

        function loadCartFromLocalStorage() {
            const storedCart = localStorage.getItem(CART_STORAGE_KEY);
            if (storedCart) {
                cart = JSON.parse(storedCart);
            } else {
                cart = [];
            }
        }

        function loadViewPreference() {
            const storedView = localStorage.getItem(COMPACT_VIEW_STORAGE_KEY);
            if (storedView === 'true') {
                isCompactView = true;
                document.body.classList.add('compact-view');
                toggleViewBtn.classList.add('active-compact-view');
                toggleViewBtn.innerHTML = '<i class="fas fa-th-list"></i>';
                toggleViewBtn.title = "عرض عادي";
            } else {
                isCompactView = false;
                document.body.classList.remove('compact-view');
                toggleViewBtn.classList.remove('active-compact-view');
                toggleViewBtn.innerHTML = '<i class="fas fa-th-large"></i>';
                toggleViewBtn.title = "عرض مضغوط";
            }
        }

        function saveViewPreference() {
            localStorage.setItem(COMPACT_VIEW_STORAGE_KEY, isCompactView);
        }

        function displayFilterButtons() {
            filtersContainer.innerHTML = '';
            const categories = ['all', ...new Set(productsData.map(p => p.category))];
            categories.forEach(category => {
                const button = document.createElement('button');
                button.classList.add('filter-btn');
                button.dataset.category = category;
                button.textContent = category === 'all' ? 'عرض الكل' : category;
                if (category === currentActiveFilter) button.classList.add('active');
                button.addEventListener('click', function() {
                    currentActiveFilter = this.dataset.category;
                    displayProducts(); // استدعاء displayProducts بدون وسيط
                    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
                filtersContainer.appendChild(button);
            });
        }

        function displayProducts() {
            menuSectionsContainer.innerHTML = '';
            let filteredProducts = productsData;

            // 1. تطبيق فلتر التصنيف
            if (currentActiveFilter !== 'all' && currentActiveFilter) {
                filteredProducts = filteredProducts.filter(p => p.category === currentActiveFilter);
            }

            // 2. تطبيق فلتر البحث
            if (currentSearchTerm) {
                const searchTermLower = currentSearchTerm.toLowerCase();
                filteredProducts = filteredProducts.filter(p =>
                    p.name.toLowerCase().includes(searchTermLower) ||
                    (p.description && p.description.toLowerCase().includes(searchTermLower)) ||
                    p.category.toLowerCase().includes(searchTermLower)
                );
            }

            if (filteredProducts.length === 0) {
                menuSectionsContainer.innerHTML = `<p style="text-align:center; padding: 20px; color: #777;">لا توجد منتجات تطابق بحثك أو الفلتر الحالي.</p>`;
                return;
            }

            const productsByCategory = filteredProducts.reduce((acc, product) => {
                if (!acc[product.category]) {
                    acc[product.category] = [];
                }
                acc[product.category].push(product);
                return acc;
            }, {});

            const displayOrderCategories = currentActiveFilter === 'all' || !currentActiveFilter
                ? [...new Set(productsData.map(p => p.category))]
                : [currentActiveFilter];

            displayOrderCategories.forEach(category => {
                const productsInCategory = productsByCategory[category];
                if (!productsInCategory || productsInCategory.length === 0) return;

                const categorySection = document.createElement('div');
                categorySection.classList.add('category-section');
                const categoryTitle = document.createElement('h2');
                categoryTitle.classList.add('category-title');
                categoryTitle.textContent = category;
                categorySection.appendChild(categoryTitle);

                const productsGrid = document.createElement('div');
                productsGrid.classList.add('products-grid');

                productsInCategory.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.classList.add('product-card');
                    let actionButtonHTML = '';
                    let priceDisplayHTML = `<p class="price">السعر: ${product.basePrice} ريال</p>`;
                    if (product.customizations && product.customizations.length > 0) {
                        priceDisplayHTML = `<p class="price">يبدأ من: ${product.basePrice} ريال</p>`;
                        actionButtonHTML = `<button class="customize-btn" onclick="openCustomizationModal('${product.id}')">حدد الخيارات <i class="fas fa-cog"></i></button>`;
                    } else {
                        actionButtonHTML = `<button class="direct-add-btn" onclick="addDirectToCart('${product.id}')">أضف للسلة <i class="fas fa-cart-plus"></i></button>`;
                    }
                    productCard.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" loading="lazy">
                        <h3>${product.name}</h3>
                        <p class="product-description">${product.description || ''}</p>
                        ${priceDisplayHTML}
                        ${actionButtonHTML}
                    `;
                    productsGrid.appendChild(productCard);
                });
                categorySection.appendChild(productsGrid);
                menuSectionsContainer.appendChild(categorySection);
            });
        }

        window.addDirectToCart = function(productId) {
            const product = productsData.find(p => p.id === productId);
            if (!product) return;
            const quantity = 1;
            const cartItemId = productId; // بدون تخصيصات، ID المنتج هو معرف السلة
            const existingItemIndex = cart.findIndex(item => item.cartItemId === cartItemId);
            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity += quantity;
            } else {
                cart.push({
                    cartItemId: cartItemId, id: productId, name: product.name,
                    basePrice: product.basePrice, finalPricePerItem: product.basePrice,
                    quantity: quantity, customizations: [], image: product.image
                });
            }
            updateCartDisplay();
            saveCartToLocalStorage();
            showNotification(`"${product.name}" أضيف إلى طلباتك.`);
        };

        function updateModalPrice() {
            if (!currentProductInModalObject) return;
            let currentPrice = currentProductInModalObject.basePrice;
            currentProductInModalObject.customizations?.forEach((group, groupIndex) => {
                const groupElement = document.getElementById(`modal-group-${currentProductInModalObject.id}-${groupIndex}`);
                if (!groupElement) return;
                if (group.type === 'radio') {
                    const selectedRadio = groupElement.querySelector(`input[name="modal-${currentProductInModalObject.id}-${group.name}"]:checked`);
                    if (selectedRadio) currentPrice += parseFloat(selectedRadio.dataset.price);
                } else if (group.type === 'checkbox') {
                    const checkedBoxes = groupElement.querySelectorAll(`input[name="modal-${currentProductInModalObject.id}-${group.name}"]:checked`);
                    checkedBoxes.forEach(cb => currentPrice += parseFloat(cb.dataset.price));
                }
            });
            modalCurrentItemPrice.textContent = `السعر مع الاضافات: ${currentPrice.toFixed(2)} ريال`;
        }

        window.openCustomizationModal = function(productId) {
             currentProductIdInModal = productId;
            currentProductInModalObject = productsData.find(p => p.id === productId);
            if (!currentProductInModalObject) return;
            modalProductImage.src = currentProductInModalObject.image;
            modalProductTitle.textContent = currentProductInModalObject.name;
            modalProductBasePrice.textContent = `السعر : ${currentProductInModalObject.basePrice} ريال`;
            modalQuantityInput.value = 1;
            modalCustomizationsContainer.innerHTML = '';
            if (currentProductInModalObject.customizations) {
                currentProductInModalObject.customizations.forEach((group, groupIndex) => {
                    const fieldset = document.createElement('fieldset');
                    fieldset.classList.add('option-group');
                    fieldset.id = `modal-group-${currentProductInModalObject.id}-${groupIndex}`;
                    const legend = document.createElement('legend');
                    legend.textContent = `${group.groupName}${group.required ? ' (مطلوب)' : ''}`;
                    fieldset.appendChild(legend);
                    group.options.forEach((opt, optIndex) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.classList.add('option-item');
                        const input = document.createElement('input');
                        input.type = group.type;
                        input.id = `modal-opt-${currentProductInModalObject.id}-${groupIndex}-${optIndex}`;
                        input.name = `modal-${currentProductInModalObject.id}-${group.name}`;
                        input.value = opt.value;
                        input.dataset.price = opt.price;
                        if (group.type === 'radio' && group.required && optIndex === 0) { // تحديد الخيار الأول كافتراضي للـ radio المطلوب
                           // input.checked = true; // يمكنك تفعيل هذا إذا أردت تحديد افتراضي
                        }
                        input.addEventListener('change', updateModalPrice);
                        const label = document.createElement('label');
                        label.htmlFor = input.id;
                        label.textContent = `${opt.text} ${opt.price > 0 ? `(+${opt.price} ريال)` : ''}`;
                        optionDiv.appendChild(input);
                        optionDiv.appendChild(label);
                        fieldset.appendChild(optionDiv);
                    });
                    modalCustomizationsContainer.appendChild(fieldset);
                });
            }
            updateModalPrice();
            modalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        modalQuantityInput.addEventListener('input', updateModalPrice);

        function closeCustomizationModal() {
            modalOverlay.classList.remove('active');
            document.body.style.overflow = '';
            currentProductIdInModal = null;
            currentProductInModalObject = null;
        }
        modalCloseBtn.addEventListener('click', closeCustomizationModal);
        modalOverlay.addEventListener('click', function(event) {
            if (event.target === modalOverlay) closeCustomizationModal();
        });

        modalAddToCartBtn.addEventListener('click', function() {
            if (!currentProductInModalObject) return;
            const product = currentProductInModalObject;
            const quantity = parseInt(modalQuantityInput.value);
            if (isNaN(quantity) || quantity <= 0) {
                alert("الرجاء تحديد كمية صحيحة."); return;
            }
            let itemPrice = product.basePrice;
            const selectedCustomizations = [];
            let cartItemIdSuffix = '';
            if (product.customizations) {
                for (let i = 0; i < product.customizations.length; i++) {
                    const group = product.customizations[i];
                    const groupElement = document.getElementById(`modal-group-${product.id}-${i}`);
                    if(!groupElement) {
                        console.error(`Group element not found: modal-group-${product.id}-${i}`);
                        continue;
                    }
                    let groupSelected = false;
                    if (group.type === 'radio') {
                        const selectedRadio = groupElement.querySelector(`input[name="modal-${product.id}-${group.name}"]:checked`);
                        if (selectedRadio) {
                            itemPrice += parseFloat(selectedRadio.dataset.price);
                            selectedCustomizations.push({
                                group: group.groupName, text: selectedRadio.labels[0].textContent.split(' (+')[0],
                                price: parseFloat(selectedRadio.dataset.price)
                            });
                            cartItemIdSuffix += `-${selectedRadio.value}`;
                            groupSelected = true;
                        }
                        if (group.required && !groupSelected) {
                            alert(`الرجاء اختيار "${group.groupName}" لمنتج "${product.name}".`); return;
                        }
                    } else if (group.type === 'checkbox') {
                        const checkedBoxes = groupElement.querySelectorAll(`input[name="modal-${product.id}-${group.name}"]:checked`);
                        checkedBoxes.forEach(cb => {
                            itemPrice += parseFloat(cb.dataset.price);
                            selectedCustomizations.push({
                                group: group.groupName, text: cb.labels[0].textContent.split(' (+')[0],
                                price: parseFloat(cb.dataset.price)
                            });
                            cartItemIdSuffix += `-${cb.value}`;
                        });
                    }
                }
            }
            const cartItemId = `${product.id}${cartItemIdSuffix}`;
            const existingItemIndex = cart.findIndex(item => item.cartItemId === cartItemId);
            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity += quantity;
            } else {
                cart.push({
                    cartItemId: cartItemId, id: product.id, name: product.name,
                    basePrice: product.basePrice, finalPricePerItem: itemPrice,
                    quantity: quantity, customizations: selectedCustomizations, image: product.image
                });
            }
            updateCartDisplay();
            saveCartToLocalStorage();
            showNotification(`"${product.name}" أضيف إلى طلباتك.`);
            closeCustomizationModal();
        });

        function showNotification(message) {
            notificationMessage.textContent = message;
            notificationToast.classList.add('show');
            if (notificationTimeout) clearTimeout(notificationTimeout);
            notificationTimeout = setTimeout(() => notificationToast.classList.remove('show'), 3000);
        }

        function updateCartDisplay() {
            cartItemsListElement.innerHTML = '';
            let subtotal = 0;
            let totalItemsCount = 0;
            const vatLineDetails = document.getElementById('vat-line-details');

            if (cart.length === 0) {
                cartItemsListElement.appendChild(emptyCartMessage);
                emptyCartMessage.style.display = 'block';
                clearCartBtn.style.display = 'none';
                if (vatLineDetails) vatLineDetails.style.display = 'none';
            } else {
                emptyCartMessage.style.display = 'none';
                clearCartBtn.style.display = 'block';
                if (vatLineDetails) vatLineDetails.style.display = 'flex';
                cart.forEach((item, index) => {
                    const listItem = document.createElement('li');
                    let customizationsText = '';
                    if (item.customizations && item.customizations.length > 0) {
                        customizationsText += '<div class="item-customizations">';
                        item.customizations.forEach(cust => {
                            customizationsText += `<div>- ${cust.text}${cust.price > 0 ? ` (+${cust.price} ر.س)` : ''}</div>`;
                        });
                        customizationsText += '</div>';
                    }
                    listItem.innerHTML = `
                        <div class="cart-item-details">
                            <span class="item-name">${item.name}</span>
                            ${customizationsText}
                            <div class="item-qty-price">الكمية: ${item.quantity} × ${item.finalPricePerItem.toFixed(2)} ر.س</div>
                        </div>
                        <div class="cart-item-actions">
                            <span class="item-total-price">${(item.finalPricePerItem * item.quantity).toFixed(2)} ر.س</span>
                            <button class="remove-item-btn" onclick="removeFromCart(${index})" aria-label="إزالة ${item.name}">
                                <i class="fas fa-minus-circle"></i>
                            </button>
                        </div>
                    `;
                    cartItemsListElement.appendChild(listItem);
                    subtotal += item.finalPricePerItem * item.quantity;
                    totalItemsCount += item.quantity;
                });
            }
            cartSubtotalAmountElement.textContent = subtotal.toFixed(2);

            const vatAmount = (subtotal * VAT_RATE) / (1 + VAT_RATE); // ضريبة القيمة المضافة من ضمن السعر
            if (cartVatAmountElement) cartVatAmountElement.textContent = vatAmount.toFixed(2);

            let currentDeliveryFee = 0;
            if (currentDeliveryType === 'delivery' && cart.length > 0) {
                currentDeliveryFee = deliveryFee;
                deliveryFeeLineElement.style.display = 'flex';
                deliveryFeeAmountElement.textContent = deliveryFee.toFixed(2);
            } else {
                deliveryFeeLineElement.style.display = 'none';
            }
            const grandTotal = subtotal + currentDeliveryFee;
            cartGrandTotalAmountElement.textContent = grandTotal.toFixed(2);
            cartCountBadge.textContent = totalItemsCount;
        }

        deliveryTypeRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                currentDeliveryType = this.value;
                updateCartDisplay();
            });
        });

        window.removeFromCart = function(itemIndex) {
            cart.splice(itemIndex, 1);
            updateCartDisplay();
            saveCartToLocalStorage();
            showNotification("تمت إزالة الوجبة من الطلبات.");
        }

        function emptyCart() {
            if (cart.length === 0) return;
            if (confirm("هل أنت متأكد أنك تريد إفراغ سلة الطلبات؟")) {
                cart = [];
                updateCartDisplay();
                saveCartToLocalStorage();
                showNotification("تم إفراغ سلة الطلبات.");
            }
        }
        clearCartBtn.addEventListener('click', emptyCart);

        function emptyCartAfterCheckout() {
            cart = [];
            updateCartDisplay();
            saveCartToLocalStorage();
            showNotification("سيتم تحويلك الى الواتساب فقط اضغط على ارسال");
            closeCartSidebar();
        }

        checkoutBtn.addEventListener('click', function() {
            if (cart.length === 0) {
                alert("سلة الطلبات فارغة. الرجاء إضافة وجبات أولاً."); return;
            }
            let message = "طلب جديد من مطعم ألتا:\n";
            message += "--------------------\n";
            let calculatedSubtotal = 0;
            cart.forEach((item, index) => {
                const itemTotal = item.finalPricePerItem * item.quantity;
                message += `\n${index + 1}. ${item.name}\n`;
                if (item.customizations && item.customizations.length > 0) {
                    message += `  التخصيصات:\n`;
                    item.customizations.forEach(cust => {
                        message += `    - ${cust.text}${cust.price > 0 ? ` (+${cust.price} ريال)` : ''}\n`;
                    });
                }
                message += `  الكمية: ${item.quantity}\n`;
                message += `  السعر للقطعة: ${item.finalPricePerItem.toFixed(2)} ريال\n`;
                message += `  إجمالي الصنف: ${itemTotal.toFixed(2)} ريال\n`;
                calculatedSubtotal += itemTotal;
            });
            message += "\n--------------------\n";
            message += `المجموع الفرعي (شامل الضريبة): ${calculatedSubtotal.toFixed(2)} ريال\n`;

            const calculatedVatAmount = (calculatedSubtotal * VAT_RATE) / (1 + VAT_RATE);
            message += `ضريبة القيمة المضافة (15%): ${calculatedVatAmount.toFixed(2)} ريال\n`;

            let finalTotalForMessage = calculatedSubtotal;

            if (currentDeliveryType === 'delivery') {
                message += `نوع الطلب: توصيل للمنزل\n`;
                message += `رسوم التوصيل: ${deliveryFee.toFixed(2)} ريال\n`;
                finalTotalForMessage += deliveryFee;
            } else {
                message += `نوع الطلب: استلام من المطعم\n`;
            }
            const generalNotes = generalOrderNotesTextarea.value.trim();
            if (generalNotes) {
                message += `\nملاحظات عامة:\n${generalNotes}\n`;
            }
            message += `\n--------------------\n`;
            message += `الإجمالي الكلي للطلب: ${finalTotalForMessage.toFixed(2)} ريال\n\n`;

     

            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_self'); // فتح في نفس الصفحة
            emptyCartAfterCheckout();
        });

        function openCartSidebar() {
            cartSidebar.classList.add('open');
            pageOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        function closeCartSidebar() {
            cartSidebar.classList.remove('open');
            pageOverlay.classList.remove('active');
            document.body.style.overflow = '';
        }
        cartToggleButton.addEventListener('click', openCartSidebar);
        closeCartButtonSidebar.addEventListener('click', closeCartSidebar);
        pageOverlay.addEventListener('click', function(event){
            if (cartSidebar.classList.contains('open') && event.target === pageOverlay) {
                closeCartSidebar();
            }
        });

        searchInput.addEventListener('input', function() {
            currentSearchTerm = this.value.trim();
            displayProducts();
        });

        toggleViewBtn.addEventListener('click', function() {
            isCompactView = !isCompactView;
            document.body.classList.toggle('compact-view', isCompactView);
            this.classList.toggle('active-compact-view', isCompactView);
            saveViewPreference();

            if (isCompactView) {
                this.innerHTML = '<i class="fas fa-th-list"></i>';
                this.title = "عرض عادي";
            } else {
                this.innerHTML = '<i class="fas fa-th-large"></i>';
                this.title = "عرض مضغوط";
            }
        });

        // Initial Load
        loadCartFromLocalStorage();
        loadViewPreference();
        displayFilterButtons();
        displayProducts();
        updateCartDisplay();

        // إضافة السنة الحالية إلى التذييل
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
